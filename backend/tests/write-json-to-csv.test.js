const fs = require('fs');
const csv = require('csv-parser');
const { writeSnirhFile } = require('../utils/read-write-and-verify-file');
const createCsvWriter = require('csv-writer').createObjectCsvWriter;



describe('Write Json to Csv', () => {

  let data = {
    AMA_DT_ANALISE: "04/04/2017",
    AMA_DT_COLETA: "04/04/2017",
    AMA_NU_CONDUTIVIDADEELETRICA: "",
    AMA_QT_BICARBONATO: "",
    AMA_QT_CALCIO: "",
    AMA_QT_CARBONATO: "",
    AMA_QT_CLORETO: "",
    AMA_QT_COLIFORMESFECAIS: "",
    AMA_QT_COLIFORMESTOTAIS: "",
    AMA_QT_DUREZATOTAL: "",
    AMA_QT_FERROTOTAL: "",
    AMA_QT_FLUORETOS: "",
    AMA_QT_MAGNESIO: "",
    AMA_QT_NITRATOS: "",
    AMA_QT_NITRITOS: "",
    AMA_QT_PH: "",
    AMA_QT_POTASSIO: "",
    AMA_QT_SODIO: "",
    AMA_QT_STD: "",
    AMA_QT_SULFATO: "",
    AMA_QT_TEMPERATURA: "",
    ASB_DS_AQUIFEROEXPLOTADO: "",
    ASB_DT_INSTALACAO: "",
    ASB_NU_ALTURABOCATUBO: "",
    ASB_NU_BASE: "",
    ASB_NU_COTATERRENO: "",
    ASB_NU_DIAMETROFILTRO: "",
    ASB_NU_DIAMETROPERFURACAO: "",
    ASB_NU_PROFUNDIDADEFINAL: "108",
    ASB_NU_TOPO: "",
    ASB_TCQ_CD: "",
    ASB_TNP_CD: "",
    ASB_TPA_CD: "",
    CTE_CD: "",
    CTE_NU_CABECAS: "",
    CTE_TCA_CD: "",
    CTE_TSC_CD: "",
    DAD_QT_DIAABR: "30",
    DAD_QT_DIAAGO: "31",
    DAD_QT_DIADEZ: "31",
    DAD_QT_DIAFEV: "28",
    DAD_QT_DIAJAN: "31",
    DAD_QT_DIAJUL: "31",
    DAD_QT_DIAJUN: "30",
    DAD_QT_DIAMAI: "31",
    DAD_QT_DIAMAR: "31",
    DAD_QT_DIANOV: "30",
    DAD_QT_DIAOUT: "31",
    DAD_QT_DIASET: "30",
    DAD_QT_HORASABR: "2",
    DAD_QT_HORASAGO: "2",
    DAD_QT_HORASDEZ: "2",
    DAD_QT_HORASFEV: "2",
    DAD_QT_HORASJAN: "2",
    DAD_QT_HORASJUL: "2",
    DAD_QT_HORASJUN: "2",
    DAD_QT_HORASMAI: "2",
    DAD_QT_HORASMAR: "2",
    DAD_QT_HORASNOV: "2",
    DAD_QT_HORASOUT: "2",
    DAD_QT_HORASSET: "2",
    DAD_QT_VAZAODIAABR: "0,09",
    DAD_QT_VAZAODIAAGO: "0,09",
    DAD_QT_VAZAODIADEZ: "0,09",
    DAD_QT_VAZAODIAFEV: "0,09",
    DAD_QT_VAZAODIAJAN: "0,09",
    DAD_QT_VAZAODIAJUL: "0,09",
    DAD_QT_VAZAODIAJUN: "0,09",
    DAD_QT_VAZAODIAMAI: "0,09",
    DAD_QT_VAZAODIAMAR: "0,09",
    DAD_QT_VAZAODIANOV: "0,09",
    DAD_QT_VAZAODIAOUT: "0,09",
    DAD_QT_VAZAODIASET: "0,09",
    EFL_NU_DBOBRUTO: "",
    EFL_NU_DBOTRATADO: "",
    EFL_NU_FOSFOROBRUTO: "",
    EFL_NU_FOSFOROTRATADO: "",
    EFL_NU_NITROGENIOBRUTO: "",
    EFL_NU_NITROGENIOTRATADO: "",
    EFL_NU_TEMPERATURA: "",
    EFL_TTE_CD: "",
    EMP_CD_IBGEMUNCORRESPONDENCIA: "",
    EMP_DS_BAIRRO: "",
    EMP_DS_COMPLEMENTOENDERECO: "",
    EMP_DS_EMAILRESPONSAVEL: "",
    EMP_DS_LOGRADOURO: "",
    EMP_NM_EMPREENDIMENTO: "CHÁCARA MIRANTE DA SERRA - LOTE 44 NÚCLEO RURAL SOBRADINHO II",
    EMP_NM_RESPONSAVEL: "TESTE SEBAST",
    EMP_NU_CAIXAPOSTAL: "",
    EMP_NU_CEPENDERECO: "",
    EMP_NU_CPFCNPJ: "#101.985.711-00",
    EMP_NU_DDD: "",
    EMP_NU_LOGRADOURO: "",
    EMP_NU_TELEFONE: "",
    ESC_CD: "",
    ESC_NU_PRODUCAOPRETENDIDA: "",
    ESC_TET_CD: "",
    ETP_CD: "",
    ETP_MPE_CD: "",
    ETP_NU_QUANTIDADEMAXMENSAL: "",
    FAH_IC_APROVEITAMENTOFIODAGUA: "",
    FAH_NU_AREAINUNDADANA: "",
    FAH_NU_POTENCIAINSTALADA: "",
    FAH_NU_VOLUMENA: "",
    FAH_TAH_CD: "",
    FEA_NU_PRODUCAOMAXMENSALAREIA: "",
    FEA_NU_PROPORCAOAGUAPOLPA: "",
    FEA_PC_TEORUMIDADE: "",
    FES_NU_AREATOTALTANQUE: "",
    FES_NU_PROFUNDIDADEMEDIATANQUE: "",
    FIE_TPS_CD: "",
    FIN_CD: 715820,
    FIN_TFN_CD: "6",
    FOH_TOH_CD: "",
    FPE_CNA_CD: "",
    FPE_TPE_CD: "",
    FRE_NU_AREAINUNDADANA: "",
    FRE_NU_VOLUMENA: "",
    FSE_TES_CD: "",
    FTE_NU_POTENCIAINSTALADA: "",
    FTE_NU_PRODUCAOMENSALMEDIA: "",
    FTE_TCO_CD: "",
    FTE_TSR_CD: "",
    FTR_AR_TOTALEMPREENDIMENTO: "",
    HTE_CD: "",
    HTE_NU_QUANTIDADE: "",
    INT_CD: "927236",
    INT_CD_ORIGEM: "",
    INT_DS_OPCIONAL: "",
    INT_NM_CORPOHIDRICOALTERADO: "",
    INT_NU_LATITUDE: "-15,631346",
    INT_NU_LONGITUDE: "-47,78455",
    INT_NU_SIAGAS: "",
    INT_TIN_CD: "1",
    INT_TSU_CD: "2",
    ITC_CD: "",
    ITC_CNA_CD: "",
    ITC_NU_PRODUCAOANUAL: "",
    ITC_TUM_CD: "",
    IUS_DT_FINALCONCESSAO: "",
    IUS_NM_ENTIDADECONCEDENTE: "",
    IUS_NU_ALTURARES: "",
    IUS_NU_AREARESMAX: "",
    IUS_NU_CONCESSAO: "",
    IUS_NU_VOLUMERES: "",
    OTO_CD: "",
    OTO_DS_OUTROUSO: "",
    OTO_NM_OUTROUSO: "",
    OTO_TOU_CD: "",
    OUT_DT_OUTORGAFINAL: "28/01/2000",
    OUT_DT_OUTORGAINICIAL: "28/02/2002",
    OUT_NU_ATO: "8612017",
    OUT_NU_PROCESSO: "",
    OUT_TP_ATO: "DESPACHO",
    OUT_TP_OUTORGA: "Direito de Uso",
    OUT_TP_SITUACAOOUTORGA: "Outorgado",
    SIR_CD: "",
    SIR_NU_AREAIRRIGADA: "",
    SIR_TCT_CD: "",
    SIR_TSI_CD: "",
    TST_DS_TEMPODURACAO: "",
    TST_NU_COEFICIENTEARMAZENAMENT: "",
    TST_NU_CONDUTIVIDADEHIDRAULICA: "",
    TST_NU_ND: "90",
    TST_NU_NE: "38",
    TST_NU_PERMEABILIDADE: "",
    TST_NU_TRANSMISSIVIDADE: "",
    TST_TMI_CD: "",
    TST_TTB_CD: "",
    TST_VZ_ESTABILIZACAO: "2.9",
    TTC_CD: "",
    TTC_TCU_CD: "",
    TUC_CD: "",
    TUC_TEC_CD: ""
  }

  let editAttributeOrder = [["INT_CD", "INT_CD_ORIGEM", "INT_DS_OPCIONAL", "INT_TIN_CD", "INT_TSU_CD", "INT_NU_SIAGAS", "INT_NU_LATITUDE", "INT_NU_LONGITUDE", "INT_NM_CORPOHIDRICOALTERADO"], ["EMP_NM_EMPREENDIMENTO", "EMP_NM_RESPONSAVEL", "EMP_NU_CPFCNPJ", "EMP_DS_EMAILRESPONSAVEL", "EMP_NU_CEPENDERECO", "EMP_DS_LOGRADOURO", "EMP_DS_COMPLEMENTOENDERECO", "EMP_NU_LOGRADOURO", "EMP_NU_CAIXAPOSTAL", "EMP_DS_BAIRRO", "EMP_NU_DDD", "EMP_NU_TELEFONE", "EMP_CD_IBGEMUNCORRESPONDENCIA"], ["OUT_TP_OUTORGA", "OUT_TP_SITUACAOOUTORGA", "OUT_DT_OUTORGAINICIAL", "OUT_DT_OUTORGAFINAL", "OUT_NU_PROCESSO", "OUT_TP_ATO", "OUT_NU_ATO"], ["DAD_QT_VAZAODIAJAN", "DAD_QT_VAZAODIAFEV", "DAD_QT_VAZAODIAMAR", "DAD_QT_VAZAODIAABR", "DAD_QT_VAZAODIAMAI", "DAD_QT_VAZAODIAJUN", "DAD_QT_VAZAODIAJUL", "DAD_QT_VAZAODIAAGO", "DAD_QT_VAZAODIASET", "DAD_QT_VAZAODIAOUT", "DAD_QT_VAZAODIANOV", "DAD_QT_VAZAODIADEZ", "DAD_QT_HORASJAN", "DAD_QT_HORASFEV", "DAD_QT_HORASMAR", "DAD_QT_HORASABR", "DAD_QT_HORASMAI", "DAD_QT_HORASJUN", "DAD_QT_HORASJUL", "DAD_QT_HORASAGO", "DAD_QT_HORASSET", "DAD_QT_HORASOUT", "DAD_QT_HORASNOV", "DAD_QT_HORASDEZ", "DAD_QT_DIAJAN", "DAD_QT_DIAFEV", "DAD_QT_DIAMAR", "DAD_QT_DIAABR", "DAD_QT_DIAMAI", "DAD_QT_DIAJUN", "DAD_QT_DIAJUL", "DAD_QT_DIAAGO", "DAD_QT_DIASET", "DAD_QT_DIAOUT", "DAD_QT_DIANOV", "DAD_QT_DIADEZ"], ["FIN_CD", "FIN_TFN_CD"], ["FES_NU_PROFUNDIDADEMEDIATANQUE", "FES_NU_AREATOTALTANQUE"], ["TTC_CD", "TTC_TCU_CD"], ["FSE_TES_CD"], ["FIE_TPS_CD"], ["FAH_TAH_CD", "FAH_NU_POTENCIAINSTALADA", "FAH_IC_APROVEITAMENTOFIODAGUA", "FAH_NU_AREAINUNDADANA", "FAH_NU_VOLUMENA"], ["FPE_TPE_CD", "FPE_CNA_CD"], ["ETP_CD", "ETP_MPE_CD", "ETP_NU_QUANTIDADEMAXMENSAL"], ["IUS_NU_ALTURARES", "IUS_NU_AREARESMAX", "IUS_NU_VOLUMERES", "IUS_NM_ENTIDADECONCEDENTE", "IUS_NU_CONCESSAO", "IUS_DT_FINALCONCESSAO"], ["SIR_CD", "SIR_TSI_CD", "SIR_TCT_CD", "SIR_NU_AREAIRRIGADA"], ["FTE_NU_POTENCIAINSTALADA", "FTE_NU_PRODUCAOMENSALMEDIA", "FTE_TCO_CD", "FTE_TSR_CD"], ["FEA_NU_PRODUCAOMAXMENSALAREIA", "FEA_NU_PROPORCAOAGUAPOLPA", "FEA_PC_TEORUMIDADE"], ["FOH_TOH_CD"], ["FRE_NU_AREAINUNDADANA", "FRE_NU_VOLUMENA"], ["OTO_TOU_CD", "OTO_CD", "OTO_NM_OUTROUSO", "OTO_DS_OUTROUSO"], ["HTE_CD", "HTE_NU_QUANTIDADE"], ["TUC_TEC_CD", "TUC_CD"], ["FTR_AR_TOTALEMPREENDIMENTO"], ["ESC_CD", "ESC_NU_PRODUCAOPRETENDIDA", "ESC_TET_CD"], ["CTE_CD", "CTE_TSC_CD", "CTE_TCA_CD", "CTE_NU_CABECAS"], ["ITC_CD", "ITC_TUM_CD", "ITC_NU_PRODUCAOANUAL", "ITC_CNA_CD"], ["EFL_NU_DBOBRUTO", "EFL_NU_DBOTRATADO", "EFL_NU_FOSFOROBRUTO", "EFL_NU_FOSFOROTRATADO", "EFL_NU_NITROGENIOBRUTO", "EFL_NU_NITROGENIOTRATADO", "EFL_NU_TEMPERATURA", "EFL_TTE_CD"], ["ASB_DT_INSTALACAO", "ASB_TNP_CD", "ASB_NU_DIAMETROPERFURACAO", "ASB_NU_DIAMETROFILTRO", "ASB_TPA_CD", "ASB_NU_TOPO", "ASB_NU_BASE", "ASB_TCQ_CD", "ASB_NU_PROFUNDIDADEFINAL", "ASB_NU_ALTURABOCATUBO", "ASB_NU_COTATERRENO", "ASB_DS_AQUIFEROEXPLOTADO"], ["TST_TTB_CD", "TST_DS_TEMPODURACAO", "TST_NU_ND", "TST_NU_NE", "TST_VZ_ESTABILIZACAO", "TST_TMI_CD", "TST_NU_COEFICIENTEARMAZENAMENT", "TST_NU_TRANSMISSIVIDADE", "TST_NU_CONDUTIVIDADEHIDRAULICA", "TST_NU_PERMEABILIDADE"], ["AMA_DT_COLETA", "AMA_DT_ANALISE", "AMA_NU_CONDUTIVIDADEELETRICA", "AMA_QT_TEMPERATURA", "AMA_QT_STD", "AMA_QT_PH", "AMA_QT_COLIFORMESTOTAIS", "AMA_QT_COLIFORMESFECAIS", "AMA_QT_BICARBONATO", "AMA_QT_CALCIO", "AMA_QT_CARBONATO", "AMA_QT_CLORETO", "AMA_QT_DUREZATOTAL", "AMA_QT_FERROTOTAL", "AMA_QT_FLUORETOS", "AMA_QT_NITRATOS", "AMA_QT_NITRITOS", "AMA_QT_POTASSIO", "AMA_QT_SODIO", "AMA_QT_SULFATO", "AMA_QT_MAGNESIO"]]

  let organizedResult = {}
  editAttributeOrder.forEach(attrs => {
    return attrs.forEach(attr => {
      organizedResult[attr]= data[attr]
    })
  });
  
  const csvWriter = createCsvWriter({
    path: './backend/data/test-write-edit-by-export-csv.csv',
    header: Object.keys(organizedResult).map(key => ({ id: key, title: key }))
  });

  csvWriter.writeRecords([organizedResult])
    .then(() => {
      console.log('CSV file has been written successfully');
    })
    .catch(err => {
      console.error('Error writing CSV file:', err);
    });

});
